# This test runs on 1 mpi process for 1 timesteps (5 million years).
# APS_new = APS_current + edot_ii*dt - strain_healing_fracture_recovery_rate * timestep
# strain_healing_fracture_recovery_rate = 1/fracture healing time.
# Here the unreal fracture healing time is 5 million years.
# The returned accumulated plastic strain (APS) values due to fracture healing should be:
# plastic_strain at the central point: initially 3 and then ~2.52.

include $ASPECT_SOURCE_DIR/tests/visco_plastic_yield_plastic_viscous_strain_healing.prm

set End time                               = 5e6
set Maximum time step                      = 5e6
set Output directory                       = visco_plastic_yield_plastic_strain_healing_fault

# Compositional fields used to track finite strain invariant
subsection Compositional fields
  set Number of fields = 1
  set Names of fields = plastic_strain
end

# We prescribe some initial strain at the center of the domain
subsection Initial composition model
  set Model name = function
  subsection Function
    set Variable names      = x,y
    set Function expression = if(x>=45.e3&x<=55.e3&y>=45.e3&y<=55.e3,3,0)
  end
end

# Material model (values for background material)
subsection Material model
  set Model name = visco plastic
  subsection Visco Plastic
    set Strain weakening mechanism = plastic weakening with plastic strain only
    set Strain healing mechanism = fracture healing
    set Strain healing fracture recovery rate = 6.34e-15
  end
end

subsection Postprocess
  set List of postprocessors =  composition statistics, velocity statistics, mass flux statistics, visualization
  subsection Visualization
    set List of output variables = viscosity, strain rate, named additional outputs
    set Output format            =   gnuplot
    set Time between graphical output = 5e6
    set Interpolate output = false
    set Point-wise stress and strain = false
    set Write higher order output = false
  end
end